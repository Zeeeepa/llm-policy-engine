apiVersion: v1
kind: Secret
metadata:
  name: llm-policy-engine-jwt
  namespace: llm-devops
  labels:
    app: llm-policy-engine
    component: policy
    secret-type: jwt
    managed-by: sealed-secrets
    environment: ${ENVIRONMENT}
    version: v1.0.0
    rotation-policy: manual
  annotations:
    description: "JWT authentication secrets for LLM Policy Engine. Contains signing keys, algorithm configuration, and token parameters for secure authentication and authorization."
    docs-url: "https://github.com/your-org/llm-policy-engine/blob/main/docs/security/jwt-authentication.md"
    rotation-schedule: "quarterly"
    llm-policy-engine.io/rotation-schedule: "quarterly"
    llm-policy-engine.io/last-rotated: "${LAST_ROTATED_DATE}"
    llm-policy-engine.io/next-rotation: "${NEXT_ROTATION_DATE}"
type: Opaque
data:
  # JWT signing secret (base64-encoded 256-bit key for symmetric algorithms like HS256)
  # Generate with: openssl rand -base64 32
  jwt-secret: ${JWT_SECRET}

  # JWT algorithm (base64-encoded): HS256, HS384, HS512, RS256, RS384, RS512, ES256, ES384, ES512
  # HS* = HMAC (symmetric), RS* = RSA (asymmetric), ES* = ECDSA (asymmetric)
  jwt-algorithm: ${JWT_ALGORITHM}

  # JWT token expiration time (base64-encoded): e.g., "1h", "24h", "7d", "3600" (seconds)
  jwt-expires-in: ${JWT_EXPIRES_IN}

  # JWT issuer (base64-encoded): identifies the principal that issued the token
  # Example: "llm-policy-engine", "https://auth.example.com"
  jwt-issuer: ${JWT_ISSUER}

  # JWT audience (base64-encoded): identifies the recipients that the JWT is intended for
  # Example: "llm-policy-engine-api", "https://api.example.com"
  jwt-audience: ${JWT_AUDIENCE}

  # JWT public key (base64-encoded): for asymmetric algorithms (RS256, ES256, etc.)
  # Leave empty for symmetric algorithms (HS256)
  # Generate RSA keypair: openssl genrsa -out private.pem 2048 && openssl rsa -in private.pem -pubout -out public.pem
  # Generate ECDSA keypair: openssl ecparam -name prime256v1 -genkey -noout -out private.pem && openssl ec -in private.pem -pubout -out public.pem
  jwt-public-key: ${JWT_PUBLIC_KEY}

  # JWT private key (base64-encoded): for asymmetric algorithms (RS256, ES256, etc.)
  # Leave empty for symmetric algorithms (HS256)
  # CRITICAL: Keep this secret secure and never commit to version control
  jwt-private-key: ${JWT_PRIVATE_KEY}
